# tcm_data_construct
## 数据标注方案
## 具体示例
### 统一化药材名称
示例：

i.	当归炭->当归。\
ii.	焦山楂、净山楂、炒山楂...->山楂。
### 病患情况
示例：

年龄：29.0，主诉：身体调理 ,现病史： 失眠，入睡困难，腰部冰冷，酸痛无力，白天疲倦，精神不佳，无明显恶寒，纳可，二便调，既往史：脂肪肝，尿酸偏高，腰椎间盘突出，舌苔脉象：舌淡红 苔白腻 脉沉。
### 脚本实现

a)	药材名称统一化
* 使用herb_uniq.py脚本，提取处方中所有使用的草药名称到herbs.txt。寻找herbs.txt中所有炮制后的草药名称，创建脚本clean_herb = re.sub(r'山楂炭', '山楂', clean_herb)，并删除herbs.txt文件中的炮制后的草药名称。
* 使用extract_herbs.py脚本，创建标准化药材名称字段，替换标准化药物名称。

b)	问诊训练问答对构建
* i.	使用generate_qa_pairs.py直接提取csv字段拼接得到json问答对。
* ii.	使用clean_sleep_qa_json_data.py对json问答对进行清理。
    * 先清理体征信息，如果无任何数字则直接删除体征信息。
    * 清理舌苔脉象，如没有记录则删除相应部分。
* iii. 使用filter_nan.py
    * 检查json数据中的input中的主述、现病史、既往史、舌苔脉象，如果为nan则删除该条数据。
    * 检查json数据中input长度是否在41-230区间，否则就删除该条数据。
    * 检查json数据output长度是否符合要求(至少14个中文字符)，否则删除该条数据。

